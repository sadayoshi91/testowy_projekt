import React, { useEffect } from 'react';

export type ToastItem = { id: string, type: 'info'|'success'|'warning'|'error', title?: string, message: string, ttl?: number };

export function Toasts({ list = [], onRemove, darkMode }: { list?: ToastItem[], onRemove: (id:string)=>void, darkMode?: boolean }) {
  useEffect(() => {
    const timers: any[] = [];
    (list || []).forEach(item => {
      const ttl = item.ttl ??1500;
      const t = setTimeout(() => onRemove(item.id), ttl);
      timers.push(t);
    });
    return () => timers.forEach(t => clearTimeout(t));
  }, [list, onRemove]);

  if (!list || list.length ===0) return null;
  return (
    <div style={{ position:'fixed', right:20, top:20, zIndex:9999, display:'flex', flexDirection:'column', gap:8 }}>
      {list.map(t => (
        <div key={t.id} style={{
          minWidth:240, padding:10, borderRadius:8, boxShadow:'0 6px 18px rgba(0,0,0,0.12)',
          background: t.type === 'success' ? (darkMode ? '#1e3d2b' : '#e6ffed') : t.type === 'error' ? (darkMode ? '#3d1e1e' : '#ffe6e6') : t.type === 'warning' ? (darkMode ? '#3d391e' : '#fff4e5') : (darkMode ? '#1e273d' : '#f0f7ff'),
          border: '1px solid rgba(0,0,0,0.06)',
          color: darkMode ? '#fff' : '#222'
        }}>
          <div style={{ fontWeight:700, marginBottom:4 }}>{t.title ?? (t.type[0].toUpperCase()+t.type.slice(1))}</div>
          <div style={{ fontSize:13 }}>{t.message}</div>
        </div>
      ))}
    </div>
  );
}
