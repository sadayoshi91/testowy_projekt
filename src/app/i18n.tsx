import React, { createContext, useContext, useMemo } from 'react';

export type Language = 'en' | 'pl';

export type Messages = Record<string, string>;

type I18nContextValue = {
  lang: Language;
  setLang: (lang: Language) => void;
  t: (key: string, params?: Record<string, string | number>) => string;
};

const FALLBACK_LANG: Language = 'en';

const defaultMessages: Record<Language, Messages> = {
  en: {
    'app.title': 'Startup Company',
    'app.subtitle': 'Build teams, win contracts and stay solvent in this neon boardroom fantasy.',
    'app.brand': 'Startup Company',
    'app.day': 'Day {value}',
    'app.funds': 'Funds {value}',
    'app.toolbar.theme': 'Toggle theme',
    'app.toolbar.pause': 'Pause',
    'app.toolbar.speed1': '1x',
    'app.toolbar.speed3': '3x',
    'app.toolbar.speed5': '5x',
    'app.toolbar.save': 'Save',
    'app.toolbar.saves': 'Saves',
    'menu.mode': 'Tycoon mode',
    'menu.new': 'Start new game',
    'menu.continue': 'Continue',
    'menu.load': 'Load save',
    'menu.options': 'Options',
    'menu.exit': 'Exit to desktop',
    'menu.back': 'Back to game',
    'menu.language': 'Language',
    'menu.language.en': 'English',
    'menu.language.pl': 'Polish',

    'options.title': 'Settings',
    'options.heading': 'Game options',
    'options.subtitle': 'Tune the simulation without leaving your executive chair.',
    'options.theme.title': 'Theme',
    'options.theme.descDark': 'You are in midnight ops mode.',
    'options.theme.descLight': 'Switch to neon noir for night sessions.',
    'options.theme.toggleLight': 'Use light theme',
    'options.theme.toggleDark': 'Use dark theme',
    'options.ticks.title': 'Tick speed',
    'options.ticks.body': 'Resume at last speed or jump to turbo meetings.',
    'options.ticks.restore': 'Restore previous speed',
    'options.save.title': 'Save management',
    'options.save.body': 'Open the save vault without leaving the dashboard.',
    'options.save.open': 'Open manager',
    'options.currency.title': 'Currency',
    'options.currency.body': 'Display cashflows in your preferred currency (avg 2024 FX).',
    'options.currency.rateHint': '1 USD ≈ {rate} {code}',
    'options.close': 'Close',

    'pause.eyebrow': 'Paused',
    'pause.title': 'Coffee break',
    'pause.body': 'Projects are on hold until you get back in the boardroom.',
    'pause.resume': 'Resume simulation',
    'pause.quick': 'Quick save',
    'pause.options': 'Options',

    'saves.title': 'Save manager',
    'saves.close': 'Close',
    'saves.quick': 'Quick save (autosave)',
    'saves.refreshing': 'Refreshing…',
    'saves.refresh': 'Refresh list',
    'saves.placeholder': 'Enter save name',
    'saves.create': 'Create save',
    'saves.loading': 'Loading saves…',
    'saves.empty': 'No saves yet. Use quick save or create one above.',
    'saves.updated': 'Updated',
    'saves.unknown': '—',
    'saves.load': 'Load',
    'saves.deleted': 'Save deleted: {name}',
    'saves.deleteFailed': 'Failed to delete save: {error}',
    'saves.nameRequired': 'Save name is required',
    'saves.nameInvalid': 'Use 3-32 letters, numbers, dash or underscore',
    'saves.saved': 'Game saved: {name}',
    'saves.saveFailed': 'Save failed: {error}',
    'saves.fetchFailed': 'Failed to read save slots',

    'assign.title': 'Assign employees',
    'assign.prod': 'Prod',
    'assign.morale': 'Morale',
    'assign.selected': 'Selected',
    'assign.work': 'Estimated work/tick',
    'assign.assign': 'Assign selected',
    'assign.cancel': 'Cancel',

    'stats.avgProductivity': 'Average productivity',
    'stats.avgMorale': 'Team morale',
    'stats.morale.great': 'Great atmosphere',
    'stats.morale.attention': 'Needs attention',
    'stats.morale.stable': 'Stable level',
    'stats.payrollCost': 'Payroll cost',
    'stats.perEmployee': 'per employee',
    'stats.teamState': 'Team state',
    'stats.avgSalary': 'Average salary',
    'stats.avgFatigue': 'Average fatigue',
    'stats.projects': 'Projects and pipeline',
    'stats.completed': 'Completed projects',
    'stats.backlog': 'Contracts in queue',
    'stats.portfolio': 'Portfolio progress',
    'stats.timeline': 'Timeline',
    'stats.noLogs': 'No logs to display.',

    'finance.funds': 'Available funds',
    'finance.payrollGross': 'Payroll gross',
    'finance.nextPayroll': 'Next payroll',
    'finance.nextInDays': 'days',
    'finance.runway': 'Runway',
    'finance.runwayHint': 'at current burn-rate',
    'finance.cycle': 'Cycle management',
    'finance.cycleHint': 'Control payrolls and export expense history.',
    'finance.runPayroll': 'Run payroll',
    'finance.export': 'Export history',
    'finance.interval': 'Payroll interval (days)',
    'finance.salaries': 'Salaries',
    'finance.noEmployees': 'No employees hired.',
    'finance.currentSalary': 'Current salary',
    'finance.newSalary': 'New value',
    'finance.update': 'Update',
    'finance.lastPayrolls': 'Recent payrolls',
    'finance.noPayrolls': 'No payrolls recorded yet.',
    'finance.confirmPayroll.title': 'Run payroll?',
    'finance.confirmPayroll.body': 'The account will be charged {amount} plus taxes and rent.',
    'finance.confirmInterval.title': 'Change payroll interval',
    'finance.confirmInterval.body': 'Set the payroll cycle to {days} days?',
    'payroll.toast.reverted': 'Last payroll reverted',
    'finance.loan.received': 'Received {amount}',

    'nav.contracts': 'Contracts',
    'nav.projects': 'Projects',
    'nav.employees': 'Employees',
    'nav.trainings': 'Trainings',
    'nav.rnd': 'R&D',
    'nav.office': 'Office',
    'nav.competitors': 'Competitors',
    'nav.events': 'Events',
    'nav.missions': 'Missions',
    'nav.stats': 'Stats',
    'nav.finance': 'Finance',
    'nav.log': 'Log',

    'game.new.started': 'Nowa gra rozpoczęta',
    'game.autosaveMissing': 'Brak autosave',
    'game.new.confirmTitle': 'Rozpocząć nową grę?',
    'game.new.confirmBody': 'Obecny postęp zostanie utracony.',

    'game.new.started': 'New game started',
    'game.autosaveMissing': 'Autosave not found',
    'game.new.confirmTitle': 'Start new game?',
    'game.new.confirmBody': 'Current progress will be lost.',

    'contracts.search': 'Search contracts',
    'contracts.difficulty.all': 'All difficulties',
    'contracts.difficulty.starter': 'Starter',
    'contracts.difficulty.standard': 'Standard',
    'contracts.difficulty.advanced': 'Advanced',
    'contracts.difficulty.expert': 'Expert',
    'contracts.hideLocked': 'Hide locked/claimed',
    'contracts.refresh': 'Refresh offers',
    'contracts.refreshCost': 'Refresh offers (-{cost})',
    'contracts.refreshTooltip': 'Not enough funds',
    'contracts.empty': 'No contracts match filters',
    'contracts.industryFallback': 'General',
    'contracts.difficultyLabel': 'Difficulty',
    'contracts.reward': 'Reward',
    'contracts.penalty': 'penalty {amount}',
    'contracts.deadline': 'Deadline',
    'contracts.deadlineNA': 'N/A',
    'contracts.days': 'days',
    'contracts.daysLeft': 'Days left',
    'contracts.expectedEffort': 'Expected effort',
    'contracts.roles': 'Roles',
    'contracts.requiresRep': 'Requires reputation {value}',
    'contracts.accept': 'Accept contract',
    'contracts.claimed': 'Claimed by {name}',
    'contracts.claimedFallback': 'competitor',
    'contracts.locked': 'Insufficient reputation',
    'contracts.accepted': 'Accepted',
    'contracts.completed': 'Completed',
    'contracts.expired': 'Expired',
    'contracts.status': 'Status',
    'contracts.status.available': 'available',
    'contracts.status.claimed': 'claimed',
    'contracts.status.locked': 'locked',
    'contracts.status.accepted': 'accepted',
    'contracts.status.completed': 'completed',
    'contracts.status.expired': 'expired',
    'contracts.acceptedToast': 'Contract accepted: {name}',
    'contracts.unavailableToast': 'Selected contract is no longer available',
    'contracts.refreshSuccess': 'Contract offers refreshed',
    'contracts.refreshError': 'Not enough funds to refresh contracts',
    'contracts.log.new': 'New contracts available: {names}',

    'projects.unnamed': 'Unnamed project',
    'projects.general': 'general',
    'projects.reward': 'Reward {amount}',
    'projects.status': 'Status {value}',
    'projects.noAssignees': 'No assignees yet',
    'projects.assignPlaceholder': 'Assign employee…',
    'projects.assign': 'Assign',
    'projects.unassignLast': 'Unassign last',
    'projects.dragHint': 'Drag employees onto this card to assign faster',
    'projects.effort': 'Effort {value}',
    'projects.rewardTag': 'Reward {value}',
    'projects.addButton': 'Add Project',
    'projects.empty': 'No projects found',
    'projects.newTitle': 'New project',
    'projects.form.name': 'Name',
    'projects.form.description': 'Description',
    'projects.form.effort': 'Effort',
    'projects.form.reward': 'Reward',
    'projects.form.roles': 'Required roles',
    'projects.create': 'Create',
    'projects.toast.nameRequired': 'Project name required',
    'projects.toast.created': 'Project {name} created',

    'projectDetails.noneSelected': 'No project selected',
    'projectDetails.unnamed': 'Unnamed project',
    'projectDetails.typeFallback': 'general',
    'projectDetails.design': 'Design',
    'projectDetails.development': 'Development',
    'projectDetails.testing': 'Testing',
    'projectDetails.goalUnknown': '—',
    'projectDetails.effort': 'Effort',
    'projectDetails.progress': 'Progress',
    'projectDetails.reward': 'Reward',
    'projectDetails.assignedCount': 'Assigned employees ({count})',
    'projectDetails.noAssignees': 'No assignees',
    'projectDetails.remove': 'Remove',
    'projectDetails.assignLabel': 'Assign employee:',
    'projectDetails.chooseEmployee': '-- choose employee --',
    'projectDetails.assign': 'Assign',
    'projectDetails.chooseAlert': 'Choose an employee to assign',
    'projectDetails.prod': 'Prod {value}',

    'employees.none': 'No employees hired yet',
    'employees.salary': 'Salary',
    'employees.prod': 'Prod',
    'employees.morale': 'Morale',
    'employees.fatigue': 'Fatigue',
    'employees.unlocked': 'Unlocked roles',
    'employees.trainingHistory': 'Training history',
    'employees.trait': 'Trait',
    'employees.recruitment.noFunds': 'Not enough funds to hire this candidate',
    'employees.recruitment.hired': '{name} hired as {role}',

    'traits.focused.label': 'Focused',
    'traits.focused.description': '+10% productivity and +5 morale on hire.',
    'traits.multidisciplinary.label': 'Multidisciplinary',
    'traits.multidisciplinary.description': '+6 to every skill (max 100).',
    'traits.mentor.label': 'Team Mentor',
    'traits.mentor.description': '+15 morale and -10 fatigue when hired.',
    'traits.sprinter.label': 'Project Sprinter',
    'traits.sprinter.description': 'Starts in fast pace with +5% productivity.',

    'employeePanel.salary': 'Salary',
    'employeePanel.prod': 'Prod',
    'employeePanel.morale': 'Morale',
    'employeePanel.fatigue': 'Fatigue',
    'employeePanel.return': 'Return',
    'employeePanel.break': 'Break',
    'employeePanel.slow': 'Slow',
    'employeePanel.normal': 'Normal',
    'employeePanel.fast': 'Fast',

    'trainings.unavailable': 'Training data unavailable.',
    'trainings.title': 'Available Trainings',
    'trainings.none': 'No trainings available',
    'trainings.role': 'Role',
    'trainings.skillGain': 'Skill gain',
    'trainings.duration': 'Duration',
    'trainings.days': 'days',
    'trainings.cost': 'Cost',
    'trainings.chooseEmployee': '-- choose employee --',
    'trainings.start': 'Start training',
    'trainings.noEligible': 'No free employees for this role',
    'trainings.assigned': 'Assigned',
    'trainings.daysLeft': 'Days left',
    'trainings.completed': 'Completed',
    'trainings.status.available': 'available',
    'trainings.status.in_progress': 'in progress',
    'trainings.status.completed': 'completed',

    'research.title': 'Research & Development',
    'research.none': 'No research available',
    'research.cost': 'Cost',
    'research.duration': 'Duration',
    'research.days': 'days',
    'research.unlocks': 'Unlocks',
    'research.start': 'Start research',
    'research.daysLeft': 'Days left',
    'research.reinvest': 'Re-invest',
    'research.invest': 'Invest ({amount})',
    'research.completed': 'Completed',

    'office.title': 'Office Management',
    'office.none': 'No offices available',
    'office.owned': '(Owned)',
    'office.forRent': '(For rent)',
    'office.rent': 'Rent',
    'office.rentAction': 'Rent this office',
    'office.desks': 'Desks:',
    'office.assigned': 'Assigned',
    'office.assignedUnknown': 'Unknown',
    'office.assignedNone': 'None',
    'office.assignPlaceholder': '-- assign employee --',
    'office.upgradeDesk': 'Upgrade desk',
    'office.mapTitle': 'Workspace Map',
    'office.toast.alreadyActive': '{name} is already active',
    'office.toast.noFunds': 'Not enough funds to rent this office',
    'office.toast.rented': '{name} rented',
    'office.toast.upgraded': 'Desk upgraded',

    'officeMap.rent': 'Rent',
    'officeMap.active': 'ACTIVE',
    'officeMap.forRent': 'FOR RENT',
    'officeMap.occupancy': 'Occupancy {occupied}/{total}',
    'officeMap.rentAction': 'Rent this office',
    'officeMap.desk': 'Desk {index}',
    'officeMap.unassigned': 'Unassigned',
    'officeMap.assignPlaceholder': '-- assign employee --',
    'officeMap.clear': 'Clear',
    'officeMap.noDesks': 'No desks defined',
    'officeMap.aiLevel': 'AI lvl {value}',

    'competitors.leader.label': 'Ranking leader',
    'competitors.leader.valueEmpty': 'No data',
    'competitors.leader.detailWaiting': 'waiting for season',
    'competitors.capital.label': 'Competitors capital',
    'competitors.capital.detail': '{count} companies',
    'competitors.contracts.label': 'Completed contracts',
    'competitors.contracts.detail': 'total',
    'competitors.reputation.label': 'Average reputation',
    'competitors.reputation.detail': 'sector trend',
    'competitors.empty': 'No competitor data. Start a campaign to discover rivals.',
    'competitors.reputation': 'Reputation',
    'competitors.contracts': 'Contracts',
    'competitors.funds': 'Funds',
    'competitors.marketDynamics': 'Market dynamics',
    'competitors.relation.friendly': 'friendly',
    'competitors.relation.neutral': 'neutral',
    'competitors.relation.hostile': 'hostile',

    'events.title': 'Game Events',
    'events.empty': 'No events yet',
    'events.day': 'Day',

    'log.title': 'Event Log',
    'log.empty': 'No events yet',

    'missions.title': 'Missions & Goals',
    'missions.empty': 'No missions yet',
    'missions.completed': 'Completed!',
    'missions.reward': 'Reward',
    'missions.total': 'total',

    'negotiation.title': 'Negotiate salary — {name}',
    'negotiation.current': 'Current salary',
    'negotiation.proposeLabel': 'Propose new salary:',
    'negotiation.cancel': 'Cancel',
    'negotiation.propose': 'Propose',

    'bankruptcy.badge': 'Funds {funds}',
    'bankruptcy.eyebrow': 'Crisis mode',
    'bankruptcy.title': 'Bankruptcy alert',
    'bankruptcy.body': 'Your cash reserves dipped below zero. Choose a lifeline to keep operations running.',
    'bankruptcy.loan.title': 'Take a short loan',
    'bankruptcy.loan.body': 'Receive +2000 now and deal with higher interest later.',
    'bankruptcy.loan.action': 'Take loan',
    'bankruptcy.investor.title': 'Seek investor',
    'bankruptcy.investor.body': 'Secure a one-time +5000 equity injection.',
    'bankruptcy.investor.action': 'Pitch investor',
    'bankruptcy.rollback.title': 'Rollback payroll',
    'bankruptcy.rollback.body': 'Undo the last payroll payout if available.',
    'bankruptcy.rollback.action': 'Rollback',

    'payrollHistory.title': 'Payroll history',
    'payrollHistory.export': 'Save to file / Export CSV',
    'payrollHistory.close': 'Close',
    'payrollHistory.empty': 'No payrolls yet',
    'payrollHistory.row': 'Payroll: {payroll} • Tax: {tax} • Rent: {rent} • Total: {total}',
    'payrollHistory.autosaveHint': 'Autosaved copy stored in localStorage key:',

    'saveResult.title': 'Save result',
    'saveResult.saved': 'Payroll history saved to:',
    'saveResult.fallback': 'Payroll history was downloaded via browser fallback.',
    'saveResult.ok': 'OK',

    'confirm.cancel': 'Cancel',
    'confirm.confirm': 'Confirm',

    'error.title': 'Something went wrong',
    'error.reload': 'Reload',

    'eventsPanel.type': '({type})',
    'eventsPanel.descriptionSeparator': '—',

    'toast.dismiss': 'Dismiss notification',
  },
  pl: {
    'app.title': 'Startup Company',
    'app.subtitle': 'Buduj zespoły, zdobywaj kontrakty i utrzymuj płynność w neonowej fantazji boardroomu.',
    'app.brand': 'Startup Company',
    'app.day': 'Dzień {value}',
    'app.funds': 'Środki {value}',
    'app.toolbar.theme': 'Przełącz motyw',
    'app.toolbar.pause': 'Pauza',
    'app.toolbar.speed1': '1x',
    'app.toolbar.speed3': '3x',
    'app.toolbar.speed5': '5x',
    'app.toolbar.save': 'Zapisz',
    'app.toolbar.saves': 'Zapisy',
    'menu.mode': 'Tryb tycoon',
    'menu.new': 'Nowa gra',
    'menu.continue': 'Kontynuuj',
    'menu.load': 'Wczytaj zapis',
    'menu.options': 'Opcje',
    'menu.exit': 'Wyjście do pulpitu',
    'menu.back': 'Powrót do gry',
    'menu.language': 'Język',
    'menu.language.en': 'Angielski',
    'menu.language.pl': 'Polski',

    'options.title': 'Ustawienia',
    'options.heading': 'Opcje gry',
    'options.subtitle': 'Dostrój symulację bez wychodzenia z gabinetu.',
    'options.theme.title': 'Motyw',
    'options.theme.descDark': 'Tryb nocnych operacji aktywny.',
    'options.theme.descLight': 'Przełącz na neonowy mrok na nocne sesje.',
    'options.theme.toggleLight': 'Użyj jasnego motywu',
    'options.theme.toggleDark': 'Użyj ciemnego motywu',
    'options.ticks.title': 'Szybkość tików',
    'options.ticks.body': 'Wznów ostatnią prędkość albo wskocz w turbo spotkania.',
    'options.ticks.restore': 'Przywróć poprzednią prędkość',
    'options.save.title': 'Zarządzanie zapisami',
    'options.save.body': 'Otwórz sejf zapisów bez opuszczania pulpitu.',
    'options.save.open': 'Otwórz menedżera',
    'options.currency.title': 'Waluta',
    'options.currency.body': 'Wyświetlaj przepływy w preferowanej walucie (średnie FX 2024).',
    'options.currency.rateHint': '1 USD ≈ {rate} {code}',
    'options.close': 'Zamknij',

    'pause.eyebrow': 'Pauza',
    'pause.title': 'Przerwa na kawę',
    'pause.body': 'Projekty czekają, aż wrócisz do gabinetu.',
    'pause.resume': 'Wznów symulację',
    'pause.quick': 'Szybki zapis',
    'pause.options': 'Opcje',

    'saves.title': 'Menedżer zapisów',
    'saves.close': 'Zamknij',
    'saves.quick': 'Szybki zapis (autosave)',
    'saves.refreshing': 'Odświeżanie…',
    'saves.refresh': 'Odśwież listę',
    'saves.placeholder': 'Podaj nazwę zapisu',
    'saves.create': 'Utwórz zapis',
    'saves.loading': 'Wczytywanie zapisów…',
    'saves.empty': 'Brak zapisów. Użyj szybkiego zapisu lub utwórz nowy powyżej.',
    'saves.updated': 'Zaktualizowano',
    'saves.unknown': '—',
    'saves.load': 'Wczytaj',
    'saves.deleted': 'Usunięto zapis: {name}',
    'saves.deleteFailed': 'Nie udało się usunąć zapisu: {error}',
    'saves.nameRequired': 'Nazwa zapisu jest wymagana',
    'saves.nameInvalid': 'Użyj 3-32 znaków: litery, cyfry, myślnik lub podkreślenie',
    'saves.saved': 'Zapisano grę: {name}',
    'saves.saveFailed': 'Błąd zapisu: {error}',
    'saves.fetchFailed': 'Nie udało się odczytać listy zapisów',

    'assign.title': 'Przypisz pracowników',
    'assign.prod': 'Prod',
    'assign.morale': 'Morale',
    'assign.selected': 'Wybrano',
    'assign.work': 'Szacowany wkład/tick',
    'assign.assign': 'Przypisz wybranych',
    'assign.cancel': 'Anuluj',

    'stats.avgProductivity': 'Średnia produktywność',
    'stats.avgMorale': 'Morale zespołu',
    'stats.morale.great': 'Świetna atmosfera',
    'stats.morale.attention': 'Wymaga uwagi',
    'stats.morale.stable': 'Stabilny poziom',
    'stats.payrollCost': 'Koszt listy płac',
    'stats.perEmployee': 'na pracownika',
    'stats.teamState': 'Stan zespołu',
    'stats.avgSalary': 'Średnia pensja',
    'stats.avgFatigue': 'Średnie zmęczenie',
    'stats.projects': 'Projekty i pipeline',
    'stats.completed': 'Ukończone projekty',
    'stats.backlog': 'Kontrakty w kolejce',
    'stats.portfolio': 'Postęp portfela',
    'stats.timeline': 'Oś czasu',
    'stats.noLogs': 'Brak logów do wyświetlenia.',

    'finance.funds': 'Środki dostępne',
    'finance.payrollGross': 'Wypłaty brutto',
    'finance.nextPayroll': 'Następny payroll',
    'finance.nextInDays': 'dni',
    'finance.runway': 'Runway',
    'finance.runwayHint': 'przy obecnym burn-rate',
    'finance.cycle': 'Zarządzanie cyklem',
    'finance.cycleHint': 'Steruj wypłatami i eksportuj historię rozchodów.',
    'finance.runPayroll': 'Uruchom payroll',
    'finance.export': 'Eksportuj historię',
    'finance.interval': 'Interwał wypłat (dni)',
    'finance.salaries': 'Wynagrodzenia',
    'finance.noEmployees': 'Brak zatrudnionych pracowników.',
    'finance.currentSalary': 'Bieżąca pensja',
    'finance.newSalary': 'Nowa wartość',
    'finance.update': 'Aktualizuj',
    'finance.lastPayrolls': 'Ostatnie wypłaty',
    'finance.noPayrolls': 'Nie zarejestrowano jeszcze żadnych wypłat.',
    'finance.confirmPayroll.title': 'Uruchomić wypłatę?',
    'finance.confirmPayroll.body': 'Z konta zostanie pobrane {amount} + podatki oraz czynsze.',
    'finance.confirmInterval.title': 'Zmień interwał wypłat',
    'finance.confirmInterval.body': 'Ustawić cykl wypłat na {days} dni?',
    'payroll.toast.reverted': 'Ostatnia wypłata cofnięta',
    'finance.loan.received': 'Otrzymano {amount}',

    'nav.contracts': 'Kontrakty',
    'nav.projects': 'Projekty',
    'nav.employees': 'Pracownicy',
    'nav.trainings': 'Szkolenia',
    'nav.rnd': 'B+R',
    'nav.office': 'Biuro',
    'nav.competitors': 'Konkurenci',
    'nav.events': 'Zdarzenia',
    'nav.missions': 'Misje',
    'nav.stats': 'Statystyki',
    'nav.finance': 'Finanse',
    'nav.log': 'Log',

    'contracts.search': 'Szukaj kontraktów',
    'contracts.difficulty.all': 'Wszystkie poziomy',
    'contracts.difficulty.starter': 'Startowy',
    'contracts.difficulty.standard': 'Standardowy',
    'contracts.difficulty.advanced': 'Zaawansowany',
    'contracts.difficulty.expert': 'Ekspercki',
    'contracts.hideLocked': 'Ukryj zablokowane/zajęte',
    'contracts.refresh': 'Odśwież oferty',
    'contracts.refreshCost': 'Odśwież oferty (-{cost})',
    'contracts.refreshTooltip': 'Brak środków',
    'contracts.empty': 'Brak kontraktów spełniających filtry',
    'contracts.industryFallback': 'Ogólne',
    'contracts.difficultyLabel': 'Poziom trudności',
    'contracts.reward': 'Nagroda',
    'contracts.penalty': 'kara {amount}',
    'contracts.deadline': 'Termin',
    'contracts.deadlineNA': 'brak',
    'contracts.days': 'dni',
    'contracts.daysLeft': 'Pozostało dni',
    'contracts.expectedEffort': 'Oczekiwany nakład',
    'contracts.roles': 'Role',
    'contracts.requiresRep': 'Wymaga reputacji {value}',
    'contracts.accept': 'Przyjmij kontrakt',
    'contracts.claimed': 'Przejęte przez {name}',
    'contracts.claimedFallback': 'konkurenta',
    'contracts.locked': 'Niewystarczająca reputacja',
    'contracts.accepted': 'Przyjęty',
    'contracts.completed': 'Ukończony',
    'contracts.expired': 'Wygasł',
    'contracts.status': 'Status',
    'contracts.status.available': 'dostępny',
    'contracts.status.claimed': 'zajęty',
    'contracts.status.locked': 'zablokowany',
    'contracts.status.accepted': 'przyjęty',
    'contracts.status.completed': 'ukończony',
    'contracts.status.expired': 'wygasły',
    'contracts.acceptedToast': 'Przyjęto kontrakt: {name}',
    'contracts.unavailableToast': 'Wybrany kontrakt nie jest już dostępny',
    'contracts.refreshSuccess': 'Oferty kontraktów odświeżone',
    'contracts.refreshError': 'Brak środków na odświeżenie kontraktów',
    'contracts.log.new': 'Nowe kontrakty: {names}',

    'projects.unnamed': 'Projekt bez nazwy',
    'projects.general': 'ogólny',
    'projects.reward': 'Nagroda {amount}',
    'projects.status': 'Status {value}',
    'projects.noAssignees': 'Brak przypisanych',
    'projects.assignPlaceholder': 'Przypisz pracownika…',
    'projects.assign': 'Przypisz',
    'projects.unassignLast': 'Odepnij ostatniego',
    'projects.dragHint': 'Przeciągnij pracowników na tę kartę, aby przypisać szybciej',
    'projects.effort': 'Nakład {value}',
    'projects.rewardTag': 'Nagroda {value}',
    'projects.addButton': 'Dodaj projekt',
    'projects.empty': 'Brak projektów',
    'projects.newTitle': 'Nowy projekt',
    'projects.form.name': 'Nazwa',
    'projects.form.description': 'Opis',
    'projects.form.effort': 'Nakład',
    'projects.form.reward': 'Nagroda',
    'projects.form.roles': 'Wymagane role',
    'projects.create': 'Utwórz',
    'projects.toast.nameRequired': 'Nazwa projektu jest wymagana',
    'projects.toast.created': 'Utworzono projekt {name}',

    'projectDetails.noneSelected': 'Nie wybrano projektu',
    'projectDetails.unnamed': 'Projekt bez nazwy',
    'projectDetails.typeFallback': 'ogólny',
    'projectDetails.design': 'Design',
    'projectDetails.development': 'Development',
    'projectDetails.testing': 'Testing',
    'projectDetails.goalUnknown': '—',
    'projectDetails.effort': 'Nakład',
    'projectDetails.progress': 'Postęp',
    'projectDetails.reward': 'Nagroda',
    'projectDetails.assignedCount': 'Przypisani pracownicy ({count})',
    'projectDetails.noAssignees': 'Brak przypisanych',
    'projectDetails.remove': 'Usuń',
    'projectDetails.assignLabel': 'Przypisz pracownika:',
    'projectDetails.chooseEmployee': '-- wybierz pracownika --',
    'projectDetails.assign': 'Przypisz',
    'projectDetails.chooseAlert': 'Wybierz pracownika do przypisania',
    'projectDetails.prod': 'Prod {value}',

    'employees.none': 'Brak zatrudnionych pracowników',
    'employees.salary': 'Pensja',
    'employees.prod': 'Prod',
    'employees.morale': 'Morale',
    'employees.fatigue': 'Zmęczenie',
    'employees.unlocked': 'Odblokowane role',
    'employees.trainingHistory': 'Historia szkoleń',
    'employees.trait': 'Cecha',
    'employees.recruitment.noFunds': 'Brak środków na zatrudnienie kandydata',
    'employees.recruitment.hired': '{name} zatrudniony jako {role}',

    'traits.focused.label': 'Skupiony',
    'traits.focused.description': '+10% produktywności i +5 morale przy zatrudnieniu.',
    'traits.multidisciplinary.label': 'Multidyscyplinarny',
    'traits.multidisciplinary.description': '+6 do każdej umiejętności (max 100).',
    'traits.mentor.label': 'Mentor zespołu',
    'traits.mentor.description': '+15 morale i -10 zmęczenia przy zatrudnieniu.',
    'traits.sprinter.label': 'Sprinter projektowy',
    'traits.sprinter.description': 'Startuje w szybkim tempie z +5% produktywności.',

    'employeePanel.salary': 'Pensja',
    'employeePanel.prod': 'Prod',
    'employeePanel.morale': 'Morale',
    'employeePanel.fatigue': 'Zmęczenie',
    'employeePanel.return': 'Wróć',
    'employeePanel.break': 'Przerwa',
    'employeePanel.slow': 'Wolno',
    'employeePanel.normal': 'Normalnie',
    'employeePanel.fast': 'Szybko',

    'trainings.unavailable': 'Dane o szkoleniach niedostępne.',
    'trainings.title': 'Dostępne szkolenia',
    'trainings.none': 'Brak dostępnych szkoleń',
    'trainings.role': 'Rola',
    'trainings.skillGain': 'Przyrost umiejętności',
    'trainings.duration': 'Czas trwania',
    'trainings.days': 'dni',
    'trainings.cost': 'Koszt',
    'trainings.chooseEmployee': '-- wybierz pracownika --',
    'trainings.start': 'Rozpocznij szkolenie',
    'trainings.noEligible': 'Brak wolnych pracowników dla tej roli',
    'trainings.assigned': 'Przypisany',
    'trainings.daysLeft': 'Pozostało dni',
    'trainings.completed': 'Ukończone',
    'trainings.status.available': 'dostępne',
    'trainings.status.in_progress': 'w trakcie',
    'trainings.status.completed': 'ukończone',

    'research.title': 'Badania i rozwój',
    'research.none': 'Brak dostępnych badań',
    'research.cost': 'Koszt',
    'research.duration': 'Czas trwania',
    'research.days': 'dni',
    'research.unlocks': 'Odblokowuje',
    'research.start': 'Rozpocznij badanie',
    'research.daysLeft': 'Pozostało dni',
    'research.reinvest': 'Dołóż środki',
    'research.invest': 'Zainwestuj ({amount})',
    'research.completed': 'Ukończono',

    'office.title': 'Zarządzanie biurem',
    'office.none': 'Brak dostępnych biur',
    'office.owned': '(Własne)',
    'office.forRent': '(Do wynajęcia)',
    'office.rent': 'Czynsz',
    'office.rentAction': 'Wynajmij to biuro',
    'office.desks': 'Biurka:',
    'office.assigned': 'Przypisany',
    'office.assignedUnknown': 'Nieznany',
    'office.assignedNone': 'Brak',
    'office.assignPlaceholder': '-- przypisz pracownika --',
    'office.upgradeDesk': 'Ulepsz biurko',
    'office.mapTitle': 'Mapa biura',
    'office.toast.alreadyActive': '{name} jest już aktywne',
    'office.toast.noFunds': 'Brak środków na wynajem biura',
    'office.toast.rented': '{name} wynajęte',
    'office.toast.upgraded': 'Biurko ulepszone',

    'officeMap.rent': 'Czynsz',
    'officeMap.active': 'AKTYWNE',
    'officeMap.forRent': 'DO WYNAJĘCIA',
    'officeMap.occupancy': 'Obłożenie {occupied}/{total}',
    'officeMap.rentAction': 'Wynajmij to biuro',
    'officeMap.desk': 'Biurko {index}',
    'officeMap.unassigned': 'Nieprzypisane',
    'officeMap.assignPlaceholder': '-- przypisz pracownika --',
    'officeMap.clear': 'Wyczyść',
    'officeMap.noDesks': 'Brak zdefiniowanych biurek',
    'officeMap.aiLevel': 'Poziom SI {value}',

    'competitors.leader.label': 'Lider rankingu',
    'competitors.leader.valueEmpty': 'Brak danych',
    'competitors.leader.detailWaiting': 'czekamy na rozgrywkę',
    'competitors.capital.label': 'Kapitał konkurentów',
    'competitors.capital.detail': '{count} firm',
    'competitors.contracts.label': 'Zakończone kontrakty',
    'competitors.contracts.detail': 'łącznie',
    'competitors.reputation.label': 'Średnia reputacja',
    'competitors.reputation.detail': 'trend sektorowy',
    'competitors.empty': 'Brak danych o konkurencji. Rozpocznij kampanię, by odkryć rywali.',
    'competitors.reputation': 'Reputacja',
    'competitors.contracts': 'Kontrakty',
    'competitors.funds': 'Środki',
    'competitors.marketDynamics': 'Dynamika rynkowa',
    'competitors.relation.friendly': 'przyjazny',
    'competitors.relation.neutral': 'neutralny',
    'competitors.relation.hostile': 'wrogi',

    'events.title': 'Zdarzenia w grze',
    'events.empty': 'Brak zdarzeń',
    'events.day': 'Dzień',

    'log.title': 'Log zdarzeń',
    'log.empty': 'Brak zdarzeń',

    'missions.title': 'Misje i cele',
    'missions.empty': 'Brak misji',
    'missions.completed': 'Ukończone!',
    'missions.reward': 'Nagroda',
    'missions.total': 'razem',

    'negotiation.title': 'Negocjacje pensji — {name}',
    'negotiation.current': 'Bieżąca pensja',
    'negotiation.proposeLabel': 'Zaproponuj nową pensję:',
    'negotiation.cancel': 'Anuluj',
    'negotiation.propose': 'Zaproponuj',

    'bankruptcy.badge': 'Środki {funds}',
    'bankruptcy.eyebrow': 'Tryb kryzysowy',
    'bankruptcy.title': 'Ostrzeżenie o bankructwie',
    'bankruptcy.body': 'Środki spadły poniżej zera. Wybierz koło ratunkowe, aby utrzymać firmę.',
    'bankruptcy.loan.title': 'Weź krótki kredyt',
    'bankruptcy.loan.body': 'Odbierz +2000 teraz i płać wyższe odsetki później.',
    'bankruptcy.loan.action': 'Weź kredyt',
    'bankruptcy.investor.title': 'Szukaj inwestora',
    'bankruptcy.investor.body': 'Pozyskaj jednorazowy zastrzyk kapitału +5000.',
    'bankruptcy.investor.action': 'Pitch dla inwestora',
    'bankruptcy.rollback.title': 'Cofnij payroll',
    'bankruptcy.rollback.body': 'Cofnij ostatnią wypłatę, jeśli dostępna.',
    'bankruptcy.rollback.action': 'Cofnij',

    'payrollHistory.title': 'Historia wypłat',
    'payrollHistory.export': 'Zapisz do pliku / Eksport CSV',
    'payrollHistory.close': 'Zamknij',
    'payrollHistory.empty': 'Brak wypłat',
    'payrollHistory.row': 'Payroll: {payroll} • Podatek: {tax} • Czynsz: {rent} • Razem: {total}',
    'payrollHistory.autosaveHint': 'Kopia autosave w localStorage pod kluczem:',

    'saveResult.title': 'Wynik zapisu',
    'saveResult.saved': 'Historia wypłat zapisana do:',
    'saveResult.fallback': 'Historię wypłat pobrano przez przeglądarkę.',
    'saveResult.ok': 'OK',

    'confirm.cancel': 'Anuluj',
    'confirm.confirm': 'Potwierdź',

    'error.title': 'Coś poszło nie tak',
    'error.reload': 'Przeładuj',

    'eventsPanel.type': '({type})',
    'eventsPanel.descriptionSeparator': '—',

    'toast.dismiss': 'Zamknij powiadomienie',
  },
};

export const I18nContext = createContext<I18nContextValue>({
  lang: FALLBACK_LANG,
  setLang: () => {},
  t: (key: string) => key,
});

function formatWithParams(template: string, params?: Record<string, string | number>) {
  if (!params) return template;
  return template.replace(/\{(.*?)\}/g, (_, p) => String(params[p] ?? ''));
}

export function I18nProvider({ lang, setLang, children }: { lang: Language; setLang: (l: Language) => void; children: React.ReactNode; }) {
  const value = useMemo<I18nContextValue>(() => ({
    lang,
    setLang,
    t: (key, params) => {
      const dictionary = defaultMessages[lang] || defaultMessages[FALLBACK_LANG];
      const fallbackDict = defaultMessages[FALLBACK_LANG];
      const msg = dictionary[key] ?? fallbackDict[key] ?? key;
      return formatWithParams(msg, params);
    },
  }), [lang, setLang]);

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export function useI18n() {
  return useContext(I18nContext);
}

export const messages = defaultMessages;
